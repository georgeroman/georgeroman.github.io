<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <base href=/ > <link href=global.css rel=stylesheet> <link href=favicon.png rel=icon type=image/png> <noscript id=sapper-head-start></noscript><title>GSoC with Servo - weeks 7 and 8</title><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> <main> <div class=siimple-content--small><div class="siimple--mx-4 siimple--my-4"><div class=siimple-h3>GSoC with Servo - weeks 7 and 8</div> <div> <p>Two more weeks have passed and things are slowly and surely improving.</p> <p>In the beginning of the seventh week I investigated why the <a href=https://github.com/servo/servo/pull/23585><code>tag name</code> selector PR</a> was failing the tests, given that these were passed when run locally. The issue seemed to be a missing <code>HOST_FILE</code> environment variable, which provides mappings from the hostnames used by the HTTP testing server to appropriate IP addresses. This was an easy fix, as the needed file already <a href=https://github.com/servo/servo/blob/master/tests/wpt/hosts>existed</a> in the codebase. However, since this issue affected all the tests that were dependent on the HTTP testing server, the fix for it caused a lot of unexpected tests results. Most of them were unexpected passes, but a few were unexpected <a href=https://build.servo.org/builders/linux-rel-wpt/builds/12913/steps/shell__5/logs/filtered-wdspec-errorsummary.log>errors occurring at the setup stage</a>, that is before the actual tests are actually run.</p> <p>Basically, when reaching <a href=https://github.com/servo/servo/blob/4470035f7540602a011b87ec25f4cbb39194c7d5/tests/wpt/web-platform-tests/webdriver/tests/support/fixtures.py#L156>this</a> line, the session, which is explicitly checked to exist a few lines before, is inexistent. I spent some good time trying to figure out why this strange anomaly occurred.</p> <p>The issue was caused by the <a href=https://github.com/servo/servo/blob/master/tests/wpt/web-platform-tests/webdriver/tests/delete_session/delete.py><code>delete_session</code></a> tests, which somehow <a href=https://github.com/servo/servo/blob/4470035f7540602a011b87ec25f4cbb39194c7d5/tests/wpt/web-platform-tests/webdriver/tests/delete_session/delete.py#L19>end</a> the current session without notifying the test harness of it. Thus, we are left with the id of a previous session, which the test harness interprets as a valid session, although in reality there is no existing session. Trying to execute commands on a session-less WebDriver instance triggers the <code>Session not created</code> errors, as in the described issue.</p> <p>As a quick fix for this I simply disabled the tests for <code>DeleteSession</code>. This issue already took a lot of time to fix so I'll come back to figuring out exactly how it happens and fixing it later when more time is available.</p> <p>These weeks, I also <a href=https://github.com/servo/servo/pull/23805>started</a> to work on implementing support for <a href=https://w3c.github.io/webdriver/#actions>actions</a> and the associated <a href=https://w3c.github.io/webdriver/#perform-actions><code>PerformActions</code></a> and <a href=https://w3c.github.io/webdriver/#release-actions><code>ReleaseActions</code></a> commands. I already have a working version which supports the <code>pause</code>, <code>keyUp</code> and <code>keyDown</code> actions, but it needs to be polished a bit before it's ready for production.</p> <p>One unfortunate thing with the <code>PerformActions</code> and <code>ReleaseActions</code> commands is that their associated <code>wpt</code> tests all have dependencies on other WebDriver commands, some of them not being yet implemented in Servo. So, most of the tests fail due to this, and the only way to check the implementation is by manually testing it. One available option, though, is to write tests that are independent of other commands.</p> <p>Besides these, I also finished implementing <a href=https://w3c.github.io/webdriver/#get-element-property><code>GetElementProperty</code></a> and <a href=https://w3c.github.io/webdriver/#link-text><code>link text</code></a> and <a href=https://w3c.github.io/webdriver/#partial-link-text><code>partial link text</code></a> selectors for <code>FindElement</code> and related commands. The PRs for these can be found <a href=https://github.com/servo/servo/pull/23820>here</a> and <a href=https://github.com/servo/servo/pull/23745>here</a>.</p> <p>These two weeks have been very productive. A lot of existing PRs are being finalized and the whole implementation is getting better, more stable and more compliant.</p> <p>Next, I will be mainly focusing on adding further support for the <a href=https://w3c.github.io/webdriver/#actions>actions</a> and <a href=https://w3c.github.io/webdriver/#interaction>interaction</a> commands, as well as getting to an end with the support for returning arrays and arbitrary objects from WebDriver.</p> </div></div></div></main></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,{post:{title:"GSoC with Servo - weeks 7 and 8",date:"2019-07-23T00:00:00.000Z",slug:"gsoc-with-servo-weeks-7-and-8",html:"\n\u003Cp\u003ETwo more weeks have passed and things are slowly and surely improving.\u003C\u002Fp\u003E\n\u003Cp\u003EIn the beginning of the seventh week I investigated why the \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fservo\u002Fservo\u002Fpull\u002F23585\"\u003E\u003Ccode\u003Etag name\u003C\u002Fcode\u003E selector PR\u003C\u002Fa\u003E was failing the tests, given that these\nwere passed when run locally.\nThe issue seemed to be a missing \u003Ccode\u003EHOST_FILE\u003C\u002Fcode\u003E environment variable, which provides mappings from the hostnames used by the HTTP testing server to appropriate IP addresses.\nThis was an easy fix, as the needed file already \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fservo\u002Fservo\u002Fblob\u002Fmaster\u002Ftests\u002Fwpt\u002Fhosts\"\u003Eexisted\u003C\u002Fa\u003E in the codebase.\nHowever, since this issue affected all the tests that were dependent on the HTTP testing server, the fix for it caused a lot of unexpected tests results.\nMost of them were unexpected passes, but a few were unexpected\n\u003Ca href=\"https:\u002F\u002Fbuild.servo.org\u002Fbuilders\u002Flinux-rel-wpt\u002Fbuilds\u002F12913\u002Fsteps\u002Fshell__5\u002Flogs\u002Ffiltered-wdspec-errorsummary.log\"\u003Eerrors occurring at the setup stage\u003C\u002Fa\u003E, that is before the actual tests are actually run.\u003C\u002Fp\u003E\n\u003Cp\u003EBasically, when reaching \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fservo\u002Fservo\u002Fblob\u002F4470035f7540602a011b87ec25f4cbb39194c7d5\u002Ftests\u002Fwpt\u002Fweb-platform-tests\u002Fwebdriver\u002Ftests\u002Fsupport\u002Ffixtures.py#L156\"\u003Ethis\u003C\u002Fa\u003E line,\nthe session, which is explicitly checked to exist a few lines before, is inexistent.\nI spent some good time trying to figure out why this strange anomaly occurred.\u003C\u002Fp\u003E\n\u003Cp\u003EThe issue was caused by the \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fservo\u002Fservo\u002Fblob\u002Fmaster\u002Ftests\u002Fwpt\u002Fweb-platform-tests\u002Fwebdriver\u002Ftests\u002Fdelete_session\u002Fdelete.py\"\u003E\u003Ccode\u003Edelete_session\u003C\u002Fcode\u003E\u003C\u002Fa\u003E tests, which somehow\n\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fservo\u002Fservo\u002Fblob\u002F4470035f7540602a011b87ec25f4cbb39194c7d5\u002Ftests\u002Fwpt\u002Fweb-platform-tests\u002Fwebdriver\u002Ftests\u002Fdelete_session\u002Fdelete.py#L19\"\u003Eend\u003C\u002Fa\u003E the current session without\nnotifying the test harness of it. Thus, we are left with the id of a previous session, which the test harness interprets as a valid session, although in reality\nthere is no existing session. Trying to execute commands on a session-less WebDriver instance triggers the \u003Ccode\u003ESession not created\u003C\u002Fcode\u003E errors, as in the described issue.\u003C\u002Fp\u003E\n\u003Cp\u003EAs a quick fix for this I simply disabled the tests for \u003Ccode\u003EDeleteSession\u003C\u002Fcode\u003E. This issue already took a lot of time to fix so I'll come back to figuring out exactly how it happens and fixing\nit later when more time is available.\u003C\u002Fp\u003E\n\u003Cp\u003EThese weeks, I also \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fservo\u002Fservo\u002Fpull\u002F23805\"\u003Estarted\u003C\u002Fa\u003E to work on implementing support for \u003Ca href=\"https:\u002F\u002Fw3c.github.io\u002Fwebdriver\u002F#actions\"\u003Eactions\u003C\u002Fa\u003E and the associated\n\u003Ca href=\"https:\u002F\u002Fw3c.github.io\u002Fwebdriver\u002F#perform-actions\"\u003E\u003Ccode\u003EPerformActions\u003C\u002Fcode\u003E\u003C\u002Fa\u003E and \u003Ca href=\"https:\u002F\u002Fw3c.github.io\u002Fwebdriver\u002F#release-actions\"\u003E\u003Ccode\u003EReleaseActions\u003C\u002Fcode\u003E\u003C\u002Fa\u003E commands.\nI already have a working version which supports the \u003Ccode\u003Epause\u003C\u002Fcode\u003E, \u003Ccode\u003EkeyUp\u003C\u002Fcode\u003E and \u003Ccode\u003EkeyDown\u003C\u002Fcode\u003E actions, but it needs to be polished a bit before it's ready for production.\u003C\u002Fp\u003E\n\u003Cp\u003EOne unfortunate thing with the \u003Ccode\u003EPerformActions\u003C\u002Fcode\u003E and \u003Ccode\u003EReleaseActions\u003C\u002Fcode\u003E commands is that their associated \u003Ccode\u003Ewpt\u003C\u002Fcode\u003E tests all have dependencies on other WebDriver commands, some of them not\nbeing yet implemented in Servo. So, most of the tests fail due to this, and the only way to check the implementation is by manually testing it.\nOne available option, though, is to write tests that are independent of other commands.\u003C\u002Fp\u003E\n\u003Cp\u003EBesides these, I also finished implementing \u003Ca href=\"https:\u002F\u002Fw3c.github.io\u002Fwebdriver\u002F#get-element-property\"\u003E\u003Ccode\u003EGetElementProperty\u003C\u002Fcode\u003E\u003C\u002Fa\u003E and \u003Ca href=\"https:\u002F\u002Fw3c.github.io\u002Fwebdriver\u002F#link-text\"\u003E\u003Ccode\u003Elink text\u003C\u002Fcode\u003E\u003C\u002Fa\u003E\nand \u003Ca href=\"https:\u002F\u002Fw3c.github.io\u002Fwebdriver\u002F#partial-link-text\"\u003E\u003Ccode\u003Epartial link text\u003C\u002Fcode\u003E\u003C\u002Fa\u003E selectors for \u003Ccode\u003EFindElement\u003C\u002Fcode\u003E and related commands. The PRs for these can be found\n\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fservo\u002Fservo\u002Fpull\u002F23820\"\u003Ehere\u003C\u002Fa\u003E and \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fservo\u002Fservo\u002Fpull\u002F23745\"\u003Ehere\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EThese two weeks have been very productive. A lot of existing PRs are being finalized and the whole implementation is getting better, more stable and more compliant.\u003C\u002Fp\u003E\n\u003Cp\u003ENext, I will be mainly focusing on adding further support for the \u003Ca href=\"https:\u002F\u002Fw3c.github.io\u002Fwebdriver\u002F#actions\"\u003Eactions\u003C\u002Fa\u003E and \u003Ca href=\"https:\u002F\u002Fw3c.github.io\u002Fwebdriver\u002F#interaction\"\u003Einteraction\u003C\u002Fa\u003E commands,\nas well as getting to an end with the support for returning arrays and arbitrary objects from WebDriver.\u003C\u002Fp\u003E\n"}}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');(function(){try{eval("async function x(){}");var main="/client/client.6087e83c.js"}catch(e){main="/client/legacy/client.d9cc21b9.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> 